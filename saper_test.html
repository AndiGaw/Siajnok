<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Przeprawa przez Arrakis ‚Äì pe≈Çny klimat</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #000;
  color: #e6c47a;
  font-family: "Georgia", serif;
  overflow-x: hidden;
}

/* ===== T≈ÅO ===== */
body.shake {
  animation: shake 0.1s infinite;
}
@keyframes shake {
  0%   { transform: translate(1px,1px); }
  25%  { transform: translate(-1px,-1px); }
  50%  { transform: translate(1px,-1px); }
  75%  { transform: translate(-1px,1px); }
  100% { transform: translate(0,0); }
}
.sand {
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(
    45deg,
    rgba(230,196,122,0.2),
    rgba(230,196,122,0.2) 2px,
    rgba(0,0,0,0) 6px
  );
  animation: drift 60s linear infinite;
  pointer-events: none;
  z-index: 1;
}

/* ===== KONTAINER ===== */
.container {
  position: relative;
  z-index: 2;
  text-align: center;
  padding-top: 20px;
}

/* ===== STEROWANIE ===== */
#controls {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  margin-bottom: 10px;
}
#controls button {
  font-size: 1.2em;
  padding: 10px 20px;
  width: 320px;
  background: #111;
  color: #e6c47a;
  border: 2px solid #e6c47a;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px rgba(230,196,122,0.5);
}
#controls button:hover {
  background: #222;
  box-shadow: 0 0 20px rgba(230,196,122,0.8);
}

#audioInfo, #stats {
  margin-top: 10px;
  font-size: 0.9em;
}

/* ===== GAME AREA ===== */
#game-area {
  display: flex;
  align-items: flex-start;
  gap: 20px;

  margin: 20px auto;
  width: max-content; /* A + plansza + B */
}

/* ===== LƒÑDOWISKA ===== */
#helipadA, #helipadB {
  width: 120px;
  height: 120px;
  background: #111;
  border: 2px solid #e6c47a;
  border-radius: 10px;

  display: flex;
  align-items: center;
  justify-content: center;

  font-weight: bold;
  flex-shrink: 0;
}

/* B istnieje od startu, ale niewidoczne */
#helipadB {
  visibility: hidden;
}

/* ===== PLANSZA ===== */
#board-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;

  /* rezerwacja miejsca = brak przesuniƒôƒá */
  min-width: calc(50px * 10 + 3px * 9);
}

#board {
  display: inline-grid;
  gap: 3px;
}

#worm-map {
  margin-top: 15px;
  display: inline-grid;
  gap: 2px;
}

/* ===== KOM√ìRKI ===== */
.cell {
  width: 50px;
  height: 50px;
  background: #222;
  border: 2px solid #e6c47a;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-weight: bold;
  font-size: 1.2em;
}

#worm-map .cell {
  width: 20px;
  height: 20px;
  font-size: 0.8em;
}

.visited { background: #444; }
.start   { background: darkgreen; }
.goal    { background: darkblue; }
.worm    { background: darkred; color: white; }
</style>
</head>

<body>
<div class="sand"></div>

<div class="container">
  <h1>Przeprawa przez Arrakis</h1>
  <p>Przejd≈∫ z punktu <b>A</b> do <b>B</b> unikajƒÖc Czerwii Pustyni!</p>

  <div id="controls">
    <button onclick="playNarrator()">üéôÔ∏è Narrator</button>
    <button onclick="startGame()">üèúÔ∏è Wyrusz w drogƒô przez piaski</button>
  </div>

  <div id="audioInfo">Kliknij gdziekolwiek aby aktywowaƒá sonar üîä</div>
  <div id="stats">Kroki: 0 | Punktacja: 0</div>

  <!-- STA≈ÅY LAYOUT -->
  <div id="game-area">
    <div id="helipadA">LƒÖdowisko A</div>

    <div id="board-wrapper">
      <div id="board"></div>
      <div id="worm-map"></div>
    </div>

    <div id="helipadB">LƒÖdowisko B</div>
  </div>
</div>

<script>
let size = 10, worms = 12;
let board = [], gameOver = false;
let playerPos = {x:0, y:0};
let steps = 0, score = 0;

function startGame() {
  const boardDiv = document.getElementById("board");
  const wormDiv  = document.getElementById("worm-map");

  board = [];
  gameOver = false;
  playerPos = {x:0, y:0};
  steps = 0;
  score = 0;

  boardDiv.innerHTML = "";
  wormDiv.innerHTML = "";

  boardDiv.style.gridTemplateColumns = `repeat(${size},50px)`;
  wormDiv.style.gridTemplateColumns  = `repeat(${size},20px)`;

  for (let y = 0; y < size; y++) {
    board[y] = [];
    for (let x = 0; x < size; x++) {
      board[y][x] = { worm:false, visited:false };

      const cell = document.createElement("div");
      cell.className = "cell";
      cell.dataset.x = x;
      cell.dataset.y = y;
      cell.onclick = () => moveTo(x,y);
      boardDiv.appendChild(cell);

      const wcell = document.createElement("div");
      wcell.className = "cell";
      wcell.dataset.x = x;
      wcell.dataset.y = y;
      wormDiv.appendChild(wcell);
    }
  }

  placeWorms();
  updateWormMap();
  drawBoard();
}

function placeWorms() {
  let placed = 0;
  while (placed < worms) {
    let x = Math.floor(Math.random() * size);
    let y = Math.floor(Math.random() * size);
    if ((x === 0 && y === 0) || (x === size-1 && y === size-1)) continue;
    if (!board[y][x].worm) {
      board[y][x].worm = true;
      placed++;
    }
  }
}
  
function updateWormMap() {
  const wormDiv = document.getElementById("worm-map");

  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      const cell = wormDiv.querySelector(
        `.cell[data-x='${x}'][data-y='${y}']`
      );
      cell.textContent = board[y][x].worm ? "ü™±" : "";
    }
  }
}
 
function isAdjacent(x,y) {
  return Math.abs(playerPos.x - x) + Math.abs(playerPos.y - y) === 1;
}

function moveTo(x,y) {
  if (gameOver || !isAdjacent(x,y)) return;

  playerPos = {x,y};
  steps++;
  board[y][x].visited = true;

  if (board[y][x].worm) {
    revealWorms();
    alert("Po≈ºar≈Ç Ciƒô Czerw Pustyni!");
    gameOver = true;
    return;
  }

  if (x === size-1 && y === size-1) {
    score = Math.max(0, 100 - steps * 2);
    alert(`Dotar≈Çe≈õ do celu! Punkty: ${score}`);
    document.getElementById("helipadB").style.visibility = "visible";
    gameOver = true;
  }

  drawBoard();
}

function drawBoard() {
  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      const cell = document.querySelector(`.cell[data-x='${x}'][data-y='${y}']`);
      cell.className = "cell";
      cell.textContent = "";

      if (board[y][x].visited) cell.classList.add("visited");
      if (x === 0 && y === 0) { cell.classList.add("start"); cell.textContent = "A"; }
      if (x === size-1 && y === size-1) { cell.classList.add("goal"); cell.textContent = "B"; }
      if (x === playerPos.x && y === playerPos.y) cell.textContent = "üë£";
    }
  }
}

function revealWorms() {
  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      if (board[y][x].worm) {
        const cell = document.querySelector(`.cell[data-x='${x}'][data-y='${y}']`);
        cell.classList.add("worm");
        cell.textContent = "ü™±";
      }
    }
  }
}

function playNarrator() {
  alert("Narrator Diuny: Witaj podr√≥≈ºniku na Arrakis...");
}
</script>
</body>
</html>
